<view class="container">

  <!-- 数据提取规则 -->
  <view class="card">
    <view class="section-title">数据提取规则</view>
    <t-input label="文件名匹配规则" placeholder="请输入正则表达式" value="{{filenamePattern}}" data-field="filenamePattern" bind:change="onInputChange" />
    
    <view class="subsection-header">
      <view class="subsection-title">按行列关键词定位数据单元</view>
      <t-icon name="help-circle" size="20px" color="#888" bind:tap="showHelpDialog"/>
    </view>
    <t-input label="行关键词" placeholder="如: 小计" value="{{rowKeyword}}" data-field="rowKeyword" bind:change="onInputChange" />
    <t-input label="行关键字所在列" type="number" placeholder="1代表A列" value="{{rowSearchColumn}}" data-field="rowSearchColumn" bind:change="onInputChange" />
    <t-input label="列关键词" placeholder="如: 大件车间" value="{{colKeyword}}" data-field="colKeyword" bind:change="onInputChange" />
    <t-input label="列关键字所在行" type="number" placeholder="如: 2" value="{{colSearchRow}}" data-field="colSearchRow" bind:change="onInputChange" />
  </view>

  <!-- 数据统计 -->
  <view class="card">
    <view class="section-title">数据管理</view>
    <t-cell title="当前记录总数" note="{{recordCount}} 条" />
    <t-cell title="导入数据" hover arrow note="从备份文件恢复" bind:tap="onImportData" />
    <t-cell title="导出数据" hover arrow note="备份所有记录到文件" bind:tap="onExportData" />
    <t-cell title="清空全部记录" hover arrow bind:tap="showClearDialog" t-class-title="cell-title-danger" />
  </view>

  <!-- 危险操作 -->
  <view class="card">
    <view class="section-title">系统设置</view>
    <t-cell title="恢复默认设置" hover arrow bind:tap="onRestoreDefault" />
  </view>

  <!-- 保存按钮 -->
  <view class="save-button-container">
    <t-button theme="primary" block bind:tap="onSave">保存设置</t-button>
  </view>

  <!-- 清空确认对话框 -->
  <t-dialog
    visible="{{dialogVisible}}"
    title="确认操作"
    content="此操作将永久删除所有记录，且无法恢复。您确定要继续吗？"
    confirm-btn="我意已决"
    cancel-btn="再想想"
    bind:confirm="onClearRecords"
    bind:cancel="hideClearDialog"
  >
  </t-dialog>

  <!-- 新增的帮助对话框 -->
  <t-dialog
    visible="{{helpDialogVisible}}"
    title="查看示例"
    content="该功能用于在Excel中动态查找数据。例如，系统会先在A列（行关键字所在列=1）找到包含“小计”（行关键词）的行，再在第2行（列关键字所在行=2）找到包含“大件车间”（列关键词）的列，最终读取这两个行列交叉位置的单元格数据。"
    confirm-btn="我明白了"
    bind:confirm="hideHelpDialog"
    show-cancel-button="{{false}}"
  >
  </t-dialog>
</view> 